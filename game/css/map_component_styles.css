/* Styles moved from css/styles.css related to map, Leaflet, grid, and other map overlays */

/* Map Container */
#map {
  height: calc(100% - 50px); /* Full height minus toolbar */
  width: 100%;
  transition: transform 0.5s ease; /* For 3D effect */
  /* Ensure map doesn't create a new stacking context that traps fixed elements,
     or if it does, its z-index is lower than modals.
     Usually, not setting a z-index or setting it to 0 or 'auto' is fine.
     Leaflet panes manage their own z-indexes internally. */
}
.map-3d { /* Class for perspective view */
  transform: perspective(1000px) rotateX(45deg);
}

/* Leaflet Control Styles */
.leaflet-control-layers-toggle { /* Makes the layer toggle icon larger */
  width: 44px !important; /* Important to override Leaflet default */
  height: 44px !important;
  background-size: 36px 36px !important;
}

.leaflet-control-scale { /* Scale control styling */
  position: fixed !important; /* Ensure it stays fixed */
  bottom: 40px !important; /* Above sticky footer */
  left: 10px !important;
  z-index: 1001 !important; /* Above map, potentially on par with sidebar */
  background-color: rgba(255, 255, 255, 0.7) !important;
  padding: 5px !important;
  border: 1px solid orange !important;
}
.leaflet-control-scale-line { /* Text color within scale */
  color: black !important;
  border-color: black !important;
}

.leaflet-popup-content-wrapper { /* Popup bubble */
  background: #111827; /* Dark background */
  border: 1px solid orange;
  color: white;
  border-radius: 6px; /* Rounded corners */
}
.leaflet-popup-tip { /* Arrow of the popup */
  background: #111827;
  border: 1px solid orange; /* Needs careful adjustment if tip is separate */
}
.leaflet-popup-content-wrapper .leaflet-popup-content { /* Text inside popup */
  color: white;
  font-size: 14px;
}

/* Grid and Subgrid Label Styles */
.subgrid-label {
  pointer-events: none; /* So labels don't interfere with map clicks */
  font-size: 12px;
  font-weight: bold;
  color: #3B82F6; /* Blue */
  text-shadow: 1px 1px 2px black;
  transform: translate(-50%, -50%); /* Center on marker position */
}
.grid-label {
  pointer-events: none;
  font-size: 12px;
  font-weight: bold;
  color: #3B82F6; /* Blue */
  text-shadow: 1px 1px 2px black;
  text-align: center;
  transform: translate(-50%, -50%);
}

/* Pulsing effect for subgrid rectangles */
@keyframes subgrid-pulse {
  0%   { stroke-opacity: 1; fill-opacity: 0.2; }
  50%  { stroke-opacity: 1; fill-opacity: 0.6; } /* More opaque at midpoint */
  100% { stroke-opacity: 1; fill-opacity: 0.2; }
}
.subgrid-rect { /* Class applied to subgrid rectangles in JS */
  animation: subgrid-pulse 1.7s ease-in-out forwards;
  stroke-opacity: 1; /* Initial/final state for animation */
  fill-opacity: 0.2;  /* Initial/final state for animation */
}

/* Terra Incognita Label Style */
.terra-label {
  color: white;
  font-size: 24px;
  font-weight: bold;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
  text-align: center;
  pointer-events: none;
}

/* Street View Panel Styles */
#street-view-panel {
  position: fixed;
  /* bottom: -100%; -- Initially hidden via lack of .open class */
  left: 0;
  width: 100%;
  height: 50%; /* Or desired height */
  background-color: rgba(30, 30, 30, 0.9); /* Dark semi-transparent */
  transition: all 0.3s; /* Smooth slide-in/out and reposition */
  z-index: 1003; /* Above map, potentially toolbar, below modals */
  border: 1px solid orange;
  display: none; /* Hidden by default */
  /* Dynamic classes 'top', 'right', 'left', 'open' (bottom) are applied by JS */
}
#street-view-panel.open,
#street-view-panel.top,
#street-view-panel.right,
#street-view-panel.left { /* When any position class is active, make it visible */
  display: block; /* Or flex if needed for internal layout */
}

#street-view-panel.open { /* Default open position (bottom) */
  bottom: 0;
  top: auto; /* Ensure top is not conflicting */
}
#street-view-panel.top {
  top: 50px; /* Below toolbar */
  bottom: auto;
  height: 50%;
  width: 100%;
}
#street-view-panel.right {
  right: 0;
  left: auto;
  top: 50px;
  width: 30%; /* Example width */
  height: calc(100% - 50px);
}
#street-view-panel.left {
  left: 0;
  right: auto;
  top: 50px;
  width: 30%; /* Example width */
  height: calc(100% - 50px);
}

#close-street-view {
  position: absolute;
  top: 10px;
  right: 10px;
  background-color: orange;
  border: none;
  color: black;
  padding: 5px 10px;
  cursor: pointer;
  z-index: 1004; /* Above street view content */
  border-radius: 3px;
}

#street-view { /* The div where Google StreetView Panorama is rendered */
  width: 100%;
  height: 100%;
}

#reposition-controls { /* Container for reposition buttons */
  position: absolute;
  top: 10px;
  left: 10px;
  z-index: 1004; /* Above street view content */
  display: flex;
  flex-direction: column; /* Stack buttons vertically */
}
.reposition-btn {
  background-color: orange;
  border: none;
  color: black;
  padding: 5px;
  margin: 2px 0; /* Vertical spacing */
  cursor: pointer;
  font-size: 20px; /* For emoji icons */
  border-radius: 3px;
  width: 30px; /* Fixed width */
  height: 30px; /* Fixed height */
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Captured Image in Street View Panel (if still used) */
#captured-image {
  position: absolute;
  top: 10px; /* Example position */
  left: 50px; /* Next to reposition controls */
  width: 20%; /* Relative width */
  max-height: 80%; /* Ensure it doesn't overflow */
  border: 1px solid orange;
  box-shadow: 0 0 10px rgba(0,0,0,0.5);
  z-index: 1005; /* Above Street View, potentially other controls */
  object-fit: contain;
}

/* Controls div that was inside street view panel - if used generally */
#controls {
  padding: 10px;
  color: white;
  /* If this is for general map controls rather than street view specific */
}
#controls input[type="range"] {
  width: 100%;
}

/* Globe view elements */
#globe-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1004;
}

#globe-container.hidden {
  display: none;
}

#globe-canvas {
  width: 100%;
  height: 100%;
}

#exit-globe-btn {
  position: absolute;
  top: 60px;
  right: 20px;
  background-color: #111827;
  border: 1px solid orange;
  color: white;
  padding: 10px 20px;
  cursor: pointer;
  z-index: 1005;
}

#map.hide-map {
  animation: mapHide 0.3s forwards;
}

@keyframes mapHide {
  to {
    transform: scale(0.5);
    opacity: 0;
  }
}